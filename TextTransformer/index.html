<!DOCTYPE html>
<html lang=en>

<head>
    <meta charset=utf-8>
    <meta content="width=device-width,initial-scale=1" name=viewport>
    <link href=favicon.png rel=icon type=image/png>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://kit.fontawesome.com/cb0a44a524.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../global.css">
    <style>
        .codeEditor,
        .lineCounter {
            font-family: monospace;
            margin: 0;
            padding: 10px 0;
            height: 75vh;
            border-radius: 1rem;
            resize: none;
            font-size: 16px;
            line-height: 1.2;
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            border-width: 0.2rem;
        }

        .lineCounter:focus-visible,
        .codeEditor:focus-visible {
            outline: none;
        }

        .lineCounter {
            display: flex;
            overflow-y: hidden;
            text-align: right;
            position: absolute;
            width: 3.5rem;
            border-top-right-radius: 0rem;
            border-bottom-right-radius: 0rem;
            /* Determine appearance of line counter */
            background-color: #20043f;
            border: solid #ffffff;
            color: #ffffff;
        }

        .codeEditor {
            padding-left: calc(3.5rem + 5px);
            width: 100%;
            white-space: pre-wrap;
            /* Determine appearance of code editor */
            background-color: #20043f;
            border: solid #ffffff;
            color: #ffffff;
        }
    </style>
    <title>ChauLe19's Page</title>
</head>

<body style="height:100%">
    <div id="fullpage" style="display:flex; flex-direction: row; height:100%">
        <div style="display:flex; flex-direction: column; width:16rem;">
            <div style="padding:1rem; font-size:2rem">
                Chau Le
            </div>
            <a href="/" class="sidebar-item">
                Home
            </a>
            <a href="/projects.html" class="sidebar-item">
                Projects

            </a>
            <div class="sidebar-item" id="contacts" style="display:flex; align-items: center;">
                <div style="padding:0.5rem">

                    <a href="https://github.com/ChauLe19">
                        <svg fill="#FFFFFF" xmlns="http://www.w3.org/2000/svg" width="2rem" height="2rem"
                            viewbox="0 0 24 24">
                            <path
                                d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
                        </svg>
                    </a>
                </div>
                <div style="padding:0.5rem">
                    <a href="https://www.linkedin.com/in/chau-le-80b713192/">
                        <svg fill="#FFFFFF" xmlns="http://www.w3.org/2000/svg" width="2rem" height="2rem"
                            viewbox="0 0 24 24">
                            <path
                                d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" />
                        </svg>
                    </a>
                </div>
            </div>
        </div>
        <div
            style="flex-grow:1;display: flex; font-size: 2rem; flex-direction: column; text-align: center; padding: 1rem;">
            <div>Text Transformer</div>
            <div style="padding-top: 1rem; padding-bottom: 1rem;">
                <div style="display:flex;flex-direction: row; font-size: 1.5rem;">
                    <div style="flex:1;">
                        <button id="clipboard-button-1"
                            style="width: 100%; border-bottom-left-radius: 0; border-bottom-right-radius: 0;">Copy to
                            clipboard</button>
                        <textarea id='lineCounter1' style="border-top-left-radius: 0;" class="lineCounter" wrap='off'
                            readonly>1.</textarea>
                        <textarea id='codeEditor1' class="codeEditor" wrap='soft' style="border-top-right-radius: 0;"
                            placeholder="Enter text here..."></textarea>
                    </div>
                    <div
                        style="display: flex; flex-direction: column; justify-content: center; align-items: center; padding-left: 1rem; padding-right: 1rem;">
                        <button type="button" onclick="transform()">Transform</button>
                        <i class="fa fa-arrow-right fa-2x"></i>
                    </div>
                    <div style="flex:1;">
                        <button id="clipboard-button-2"
                            style="width: 100%; border-bottom-left-radius: 0; border-bottom-right-radius: 0;">Copy to
                            clipboard</button>
                        <textarea id='lineCounter2' class="lineCounter" style="border-top-left-radius: 0;" wrap='off'
                            readonly>1.</textarea>
                        <textarea id='codeEditor2' class="codeEditor" wrap='soft' style="border-top-right-radius: 0;"
                            placeholder="Transformed text will be output here..."></textarea>
                    </div>
                </div>
            </div>
            <div style="display: flex; flex-grow: 1; padding-top: 1rem; padding-bottom: 1rem;">
            </div>
            <i class="fa-solid fa-arrow-up fa-2x"></i>
            <div>
                <select name="func" id="func-select">
                </select>
                <button type="button" onclick="save()">Save</button>
            </div>
            <div style="text-align: left;">
                <span style="font-size: 1rem; padding-left: 3.5rem;">function transform(text) {</span>
                <textarea id='lineCounter3' class="lineCounter" wrap='off' readonly>1.</textarea>
                <textarea id='codeEditor3' class="codeEditor" wrap='soft'>
                </textarea>
                <span style="font-size: 1rem; padding-left: 3.5rem;">}</span>
            </div>
        </div>
    </div>
    </div>
</body>
<script>
    const cb1 = document.getElementById('clipboard-button-1');
    const cb2 = document.getElementById('clipboard-button-2');
    var clipboardTimeout1;
    var clipboardTimeout2;
    const functionSelect = document.getElementById('func-select');
    function populateFunctionOptions() {
        functionSelect.innerHTML = ""
        for (const key of Object.keys(localStorage)) {
            const dropdownItem = document.createElement("option");
            dropdownItem.value = key;
            dropdownItem.innerText = key;
            functionSelect.append(dropdownItem)
        }
    }
    populateFunctionOptions();
    var codeEditor1 = document.getElementById('codeEditor1');
    var lineCounter1 = document.getElementById('lineCounter1');
    var codeEditor2 = document.getElementById('codeEditor2');
    var lineCounter2 = document.getElementById('lineCounter2');
    var codeEditor3 = document.getElementById('codeEditor3');
    var lineCounter3 = document.getElementById('lineCounter3');
    codeEditor3.value = "return text"
    if (Object.keys(localStorage).length > 0) {
        codeEditor3.value = localStorage.getItem(functionSelect.options[0].value)
    }

    functionSelect.onchange = function () {
        codeEditor3.value = localStorage.getItem(this.options[this.selectedIndex].value)
        line_counter(codeEditor3, lineCounter3)
    }
    line_counter(codeEditor3, lineCounter3)
    addTextareaEvents(codeEditor1, lineCounter1);
    addTextareaEvents(codeEditor2, lineCounter2);
    addTextareaEvents(codeEditor3, lineCounter3);
    function addTextareaEvents(codeEditor, lineCounter) {
        codeEditor.addEventListener('scroll', () => {
            lineCounter.scrollTop = codeEditor.scrollTop;
            lineCounter.scrollLeft = codeEditor.scrollLeft;
        });

        codeEditor.addEventListener('keydown', (e) => {
            let { keyCode } = e;
            let { value, selectionStart, selectionEnd } = codeEditor; if (keyCode === 9) {  // TAB = 9
                e.preventDefault();
                codeEditor.value = value.slice(0, selectionStart) + '\t' + value.slice(selectionEnd);
                codeEditor.setSelectionRange(selectionStart + 2, selectionStart + 2)
            }
        });

        var lineCountCache = 0;
        codeEditor.addEventListener('input', () => {
            line_counter(codeEditor, lineCounter, lineCountCache);
        });
    }
    function line_counter(codeEditor, lineCounter, lineCountCache) {
        const lineCount = codeEditor.value.split('\n').length;
        var outarr = new Array();
        if (lineCountCache != lineCount) {
            for (var x = 0; x < lineCount; x++) {
                outarr[x] = (x + 1) + '.';
            }
            lineCounter.value = outarr.join('\n');
        }
        lineCountCache = lineCount;
    }

    cb1.onclick = () => {
        copy2Clipboard(cb1, codeEditor1, clipboardTimeout1);
    }
    cb2.onclick = () => {
        copy2Clipboard(cb2, codeEditor2, clipboardTimeout2);
    }
    function copy2Clipboard(cb, codeEditor, clipboardTimeout) {
        navigator.clipboard.writeText(codeEditor.value);
        cb.innerText = 'Copied!'
        clearTimeout(clipboardTimeout)
        clipboardTimeout = setTimeout(() => cb.innerText = 'Copy to clipboard', 3000);
    }

    function transform() {
        const fn = new Function(['text'], codeEditor3.value)
        result = fn(codeEditor1.value);
        codeEditor2.value = typeof result === 'object' ? JSON.stringify(result) : result
    }

    function save() {
        let cacheName;
        let name = prompt("Please enter the transformation name: ");
        if (name == null || name == "") {
        } else {
            if (localStorage.getItem(name)) {
                alert("This name already exists! Please change its name or delete the existing one and try again.");
            }
            else {
                localStorage.setItem(name, codeEditor3.value);
                alert("Saved!");
                populateFunctionOptions();
            }
        }
    }
</script>

</html>